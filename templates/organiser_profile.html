{% extends 'organiser_base.html' %}

{% block title %}CEMS - Organiser Profile{% endblock %}

{% block page_title %}Organiser Profile{% endblock %}

{% block extra_styles %}
.profile-section {
    background-color: white;
    border-radius: 10px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
    padding: 20px;
    margin-bottom: 20px;
}

.profile-header {
    display: flex;
    align-items: center;
    margin-bottom: 20px;
}

.profile-avatar {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    object-fit: cover;
    margin-right: 20px;
    border: 3px solid var(--primary-color);
}

.avatar-placeholder {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    background-color: #e9ecef;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 20px;
    font-size: 2.5rem;
    color: #adb5bd;
}

.profile-stats {
    display: flex;
    flex-wrap: wrap;
    margin-bottom: 20px;
}

.stat-item {
    padding: 15px;
    background-color: #f8f9fa;
    border-radius: 10px;
    margin-right: 15px;
    margin-bottom: 15px;
    min-width: 120px;
    text-align: center;
    transition: transform 0.2s;
}

.stat-item:hover {
    transform: translateY(-5px);
    box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
}

.stat-value {
    font-size: 1.5rem;
    font-weight: bold;
    display: block;
}

.stat-label {
    font-size: 0.8rem;
    color: #6c757d;
}

.nav-pills .nav-link.active {
    background-color: var(--primary-color);
}

.tab-content {
    padding: 20px;
    background-color: white;
    border-radius: 0 0 10px 10px;
}

.verification-badge {
    background-color: #e3fcef;
    color: #00a854;
    border-radius: 50px;
    padding: 5px 10px;
    font-size: 12px;
    font-weight: bold;
    display: inline-flex;
    align-items: center;
}

.verification-badge i {
    margin-right: 5px;
}

.verification-pending {
    background-color: #fff7e6;
    color: #fa8c16;
}

.verification-rejected {
    background-color: #fff1f0;
    color: #f5222d;
}

.document-card {
    border: 1px dashed #dee2e6;
    border-radius: 8px;
    padding: 15px;
    margin-bottom: 15px;
    background-color: #f8f9fa;
    transition: all 0.2s;
}

.document-card:hover {
    border-color: var(--primary-color);
}

.document-card.uploaded {
    border-style: solid;
    border-color: #28a745;
    background-color: #f0fff4;
}

.social-links {
    display: flex;
    gap: 10px;
    margin-top: 10px;
}

.social-icon {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: #f8f9fa;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #6c757d;
    transition: all 0.2s;
}

.social-icon:hover {
    transform: translateY(-3px);
}

.facebook:hover {
    background-color: #3b5998;
    color: white;
}

.instagram:hover {
    background-color: #e1306c;
    color: white;
}

.twitter:hover {
    background-color: #1da1f2;
    color: white;
}

.linkedin:hover {
    background-color: #0077b5;
    color: white;
}

.subscription-card {
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
    margin-bottom: 20px;
}

.subscription-header {
    padding: 15px;
    background-color: #e9ecef;
    font-weight: bold;
    text-align: center;
}

.subscription-free .subscription-header {
    background-color: #e3fcef;
    color: #00a854;
}

.subscription-premium .subscription-header {
    background-color: #fff1f0;
    color: #f5222d;
}

.subscription-body {
    padding: 15px;
    background-color: white;
}

.upsell-card {
    background: linear-gradient(45deg, #3e64ff, #5edfff);
    color: white;
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 20px;
}
{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <!-- Profile Information -->
        <div class="col-lg-8">
            <div class="profile-section">
                <div class="profile-header">
                    <div id="avatarContainer">
                        <!-- Will be populated with image or placeholder -->
                    </div>
                    <div>
                        <h3 id="organiserName">Loading...</h3>
                        <div id="verificationStatus"></div>
                        <div class="social-links">
                            <a href="#" class="social-icon facebook" title="Facebook">
                                <i class="fab fa-facebook-f"></i>
                            </a>
                            <a href="#" class="social-icon instagram" title="Instagram">
                                <i class="fab fa-instagram"></i>
                            </a>
                            <a href="#" class="social-icon twitter" title="Twitter">
                                <i class="fab fa-twitter"></i>
                            </a>
                            <a href="#" class="social-icon linkedin" title="LinkedIn">
                                <i class="fab fa-linkedin-in"></i>
                            </a>
                            <button class="btn btn-sm btn-outline-secondary ms-2" data-bs-toggle="modal" data-bs-target="#socialLinksModal">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="profile-stats">
                    <div class="stat-item">
                        <span class="stat-value" id="eventsCreated">-</span>
                        <span class="stat-label">Events Created</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="totalParticipants">-</span>
                        <span class="stat-label">Participants</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="averageRating">-</span>
                        <span class="stat-label">Avg. Rating</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="totalRevenue">-</span>
                        <span class="stat-label">Total Revenue</span>
                    </div>
                </div>
                
                <ul class="nav nav-pills mb-3" id="profileTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="info-tab" data-bs-toggle="pill" data-bs-target="#info" type="button" role="tab" aria-controls="info" aria-selected="true">Basic Info</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="verification-tab" data-bs-toggle="pill" data-bs-target="#verification" type="button" role="tab" aria-controls="verification" aria-selected="false">Verification</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="payment-tab" data-bs-toggle="pill" data-bs-target="#payment" type="button" role="tab" aria-controls="payment" aria-selected="false">Payment Info</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="subscription-tab" data-bs-toggle="pill" data-bs-target="#subscription" type="button" role="tab" aria-controls="subscription" aria-selected="false">Subscription</button>
                    </li>
                </ul>
                
                <div class="tab-content" id="profileTabsContent">
                    <!-- Basic Info Tab -->
                    <div class="tab-pane fade show active" id="info" role="tabpanel" aria-labelledby="info-tab">
                        <form id="profileForm">
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="fullName" class="form-label">Full Name</label>
                                    <input type="text" class="form-control" id="fullName">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="displayName" class="form-label">Display Name / Organization Name</label>
                                    <input type="text" class="form-control" id="displayName">
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="email" class="form-label">Email</label>
                                    <input type="email" class="form-control" id="email" readonly>
                                    <div class="form-text">Email cannot be changed. Contact support for assistance.</div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="phone" class="form-label">Phone</label>
                                    <input type="text" class="form-control" id="phone">
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="biography" class="form-label">Biography/About</label>
                                <textarea class="form-control" id="biography" rows="3"></textarea>
                            </div>
                            
                            <div class="mb-3">
                                <label for="address" class="form-label">Address</label>
                                <textarea class="form-control" id="address" rows="2"></textarea>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="city" class="form-label">City</label>
                                    <input type="text" class="form-control" id="city">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="state" class="form-label">State</label>
                                    <input type="text" class="form-control" id="state">
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="profilePic" class="form-label">Profile Picture</label>
                                <input class="form-control" type="file" id="profilePic" accept="image/*">
                            </div>
                            
                            <button type="submit" class="btn btn-primary">Save Changes</button>
                        </form>
                    </div>
                    
                    <!-- Verification Tab -->
                    <div class="tab-pane fade" id="verification" role="tabpanel" aria-labelledby="verification-tab">
                        <div id="verificationInfo" class="mb-4">
                            <h5>Verification Status</h5>
                            <div id="verificationStatusDetails">Loading verification status...</div>
                        </div>
                        
                        <h5>Required Documents</h5>
                        <p class="text-muted mb-3">Please upload the following documents to verify your organiser account. All documents must be clear and valid.</p>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <div id="idProof" class="document-card">
                                    <h6><i class="fas fa-id-card me-2"></i> ID Proof</h6>
                                    <p class="text-muted small">Upload your government issued ID card (Aadhar, PAN, Passport, etc.)</p>
                                    <input type="file" class="form-control form-control-sm" id="idProofFile" accept="image/*,.pdf">
                                    <div id="idProofStatus" class="small mt-2"></div>
                                </div>
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <div id="addressProof" class="document-card">
                                    <h6><i class="fas fa-home me-2"></i> Address Proof</h6>
                                    <p class="text-muted small">Upload a document that verifies your address (Utility bill, etc.)</p>
                                    <input type="file" class="form-control form-control-sm" id="addressProofFile" accept="image/*,.pdf">
                                    <div id="addressProofStatus" class="small mt-2"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <div id="organizationProof" class="document-card">
                                    <h6><i class="fas fa-building me-2"></i> Organization Proof</h6>
                                    <p class="text-muted small">Upload registration certificate or business license</p>
                                    <input type="file" class="form-control form-control-sm" id="organizationProofFile" accept="image/*,.pdf">
                                    <div id="organizationProofStatus" class="small mt-2"></div>
                                </div>
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <div id="otherDocument" class="document-card">
                                    <h6><i class="fas fa-file-alt me-2"></i> Other Supporting Document</h6>
                                    <p class="text-muted small">Any other document that might help with verification</p>
                                    <input type="file" class="form-control form-control-sm" id="otherDocumentFile" accept="image/*,.pdf">
                                    <div id="otherDocumentStatus" class="small mt-2"></div>
                                </div>
                            </div>
                        </div>
                        
                        <button type="button" class="btn btn-primary" id="submitVerificationBtn">Submit for Verification</button>
                    </div>
                    
                    <!-- Payment Info Tab -->
                    <div class="tab-pane fade" id="payment" role="tabpanel" aria-labelledby="payment-tab">
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle me-2"></i>
                            Your payment information is used to receive payments from ticket sales and other event revenue.
                        </div>
                        
                        <form id="paymentInfoForm">
                            <div class="mb-3">
                                <label class="form-label">Payment Method</label>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="paymentMethod" id="bankTransfer" value="bank_transfer" checked>
                                    <label class="form-check-label" for="bankTransfer">
                                        Bank Transfer
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="paymentMethod" id="upi" value="upi">
                                    <label class="form-check-label" for="upi">
                                        UPI
                                    </label>
                                </div>
                            </div>
                            
                            <!-- Bank Transfer Details -->
                            <div id="bankTransferDetails">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="accountHolder" class="form-label">Account Holder Name</label>
                                        <input type="text" class="form-control" id="accountHolder">
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="accountNumber" class="form-label">Account Number</label>
                                        <input type="text" class="form-control" id="accountNumber">
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="ifscCode" class="form-label">IFSC Code</label>
                                        <input type="text" class="form-control" id="ifscCode">
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="bankName" class="form-label">Bank Name</label>
                                        <input type="text" class="form-control" id="bankName">
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="branchName" class="form-label">Branch Name</label>
                                        <input type="text" class="form-control" id="branchName">
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="accountType" class="form-label">Account Type</label>
                                        <select class="form-select" id="accountType">
                                            <option value="savings">Savings</option>
                                            <option value="current">Current</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- UPI Details -->
                            <div id="upiDetails" style="display: none;">
                                <div class="mb-3">
                                    <label for="upiId" class="form-label">UPI ID</label>
                                    <input type="text" class="form-control" id="upiId" placeholder="username@bankname">
                                    <div class="form-text">Enter your UPI ID in the format username@bankname</div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="upiName" class="form-label">Name Registered with UPI</label>
                                    <input type="text" class="form-control" id="upiName">
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="panNumber" class="form-label">PAN Number</label>
                                <input type="text" class="form-control" id="panNumber" placeholder="ABCDE1234F">
                                <div class="form-text">Required for tax purposes</div>
                            </div>
                            
                            <button type="submit" class="btn btn-primary">Save Payment Information</button>
                        </form>
                    </div>
                    
                    <!-- Subscription Tab -->
                    <div class="tab-pane fade" id="subscription" role="tabpanel" aria-labelledby="subscription-tab">
                        <h5 class="mb-4">Your Current Subscription</h5>
                        
                        <div class="subscription-card subscription-free">
                            <div class="subscription-header">
                                <h5>Free Plan</h5>
                            </div>
                            <div class="subscription-body">
                                <ul class="list-unstyled">
                                    <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i> Create up to 3 events</li>
                                    <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i> Basic analytics</li>
                                    <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i> Standard support</li>
                                    <li class="mb-2"><i class="fas fa-times-circle text-danger me-2"></i> Premium features</li>
                                    <li class="mb-2"><i class="fas fa-times-circle text-danger me-2"></i> Priority support</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="upsell-card">
                            <h5>Upgrade to Premium</h5>
                            <p class="mb-3">Get access to all premium features and create unlimited events!</p>
                            <ul class="list-unstyled mb-3">
                                <li class="mb-2"><i class="fas fa-check-circle me-2"></i> Unlimited events</li>
                                <li class="mb-2"><i class="fas fa-check-circle me-2"></i> Advanced analytics</li>
                                <li class="mb-2"><i class="fas fa-check-circle me-2"></i> Priority support</li>
                                <li class="mb-2"><i class="fas fa-check-circle me-2"></i> Custom branding</li>
                                <li class="mb-2"><i class="fas fa-check-circle me-2"></i> Early access to new features</li>
                            </ul>
                            <button class="btn btn-light" data-bs-toggle="modal" data-bs-target="#upgradePlanModal">
                                <i class="fas fa-crown me-2"></i> Upgrade Now
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Account Settings & Security -->
        <div class="col-lg-4">
            <div class="profile-section">
                <h5 class="mb-3">Account Settings</h5>
                
                <div class="mb-3">
                    <label class="form-label">Email Notifications</label>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="eventUpdates" checked>
                        <label class="form-check-label" for="eventUpdates">Event updates</label>
                    </div>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="newRegistrations" checked>
                        <label class="form-check-label" for="newRegistrations">New registrations</label>
                    </div>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="paymentAlerts" checked>
                        <label class="form-check-label" for="paymentAlerts">Payment alerts</label>
                    </div>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="marketingEmails">
                        <label class="form-check-label" for="marketingEmails">Marketing emails</label>
                    </div>
                </div>
                
                <hr>
                
                <h5 class="mb-3">Security</h5>
                
                <div class="d-grid gap-2">
                    <button type="button" class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#changePasswordModal">
                        <i class="fas fa-lock me-2"></i> Change Password
                    </button>
                    <button type="button" class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#enable2FAModal">
                        <i class="fas fa-shield-alt me-2"></i> Enable Two-Factor Authentication
                    </button>
                </div>
                
                <hr>
                
                <h5 class="mb-3">Account Actions</h5>
                
                <div class="d-grid gap-2">
                    <button type="button" class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#deactivateAccountModal">
                        <i class="fas fa-pause-circle me-2"></i> Deactivate Account
                    </button>
                    <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#deleteAccountModal">
                        <i class="fas fa-trash-alt me-2"></i> Delete Account
                    </button>
                </div>
            </div>
            
            <!-- Activity Log -->
            <div class="profile-section">
                <h5 class="mb-3">Recent Activity</h5>
                <ul class="list-group list-group-flush" id="activityLog">
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <div>
                            <div><strong>Profile updated</strong></div>
                            <small class="text-muted">You updated your profile information</small>
                        </div>
                        <small class="text-muted">2 days ago</small>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <div>
                            <div><strong>New event created</strong></div>
                            <small class="text-muted">You created event "Technical Workshop"</small>
                        </div>
                        <small class="text-muted">5 days ago</small>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <div>
                            <div><strong>Password changed</strong></div>
                            <small class="text-muted">You changed your account password</small>
                        </div>
                        <small class="text-muted">1 week ago</small>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>

<!-- Social Links Modal -->
<div class="modal fade" id="socialLinksModal" tabindex="-1" aria-labelledby="socialLinksModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="socialLinksModalLabel">Edit Social Links</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="socialLinksForm">
                    <div class="mb-3">
                        <label for="facebookLink" class="form-label">Facebook Profile URL</label>
                        <input type="text" class="form-control" id="facebookLink">
                    </div>
                    <div class="mb-3">
                        <label for="instagramLink" class="form-label">Instagram Profile URL</label>
                        <input type="text" class="form-control" id="instagramLink">
                    </div>
                    <div class="mb-3">
                        <label for="twitterLink" class="form-label">Twitter Profile URL</label>
                        <input type="text" class="form-control" id="twitterLink">
                    </div>
                    <div class="mb-3">
                        <label for="linkedinLink" class="form-label">LinkedIn Profile URL</label>
                        <input type="text" class="form-control" id="linkedinLink">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="saveSocialLinks">Save changes</button>
            </div>
        </div>
    </div>
</div>

<!-- Change Password Modal -->
<div class="modal fade" id="changePasswordModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Change Password</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="changePasswordForm">
                    <div class="mb-3">
                        <label for="currentPassword" class="form-label">Current Password</label>
                        <input type="password" class="form-control" id="currentPassword" required>
                    </div>
                    <div class="mb-3">
                        <label for="newPassword" class="form-label">New Password</label>
                        <input type="password" class="form-control" id="newPassword" required>
                    </div>
                    <div class="mb-3">
                        <label for="confirmPassword" class="form-label">Confirm New Password</label>
                        <input type="password" class="form-control" id="confirmPassword" required>
                        <div id="passwordMatchError" class="invalid-feedback">
                            Passwords do not match.
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="saveNewPassword">Change Password</button>
            </div>
        </div>
    </div>
</div>

<!-- Upgrade Plan Modal -->
<div class="modal fade" id="upgradePlanModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Upgrade to Premium</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="subscription-card subscription-premium">
                    <div class="subscription-header">
                        <h5>Premium Plan - ₹499/month</h5>
                    </div>
                    <div class="subscription-body">
                        <p class="mb-3">Get access to all premium features and create unlimited events!</p>
                        <ul class="list-unstyled mb-3">
                            <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i> Unlimited events</li>
                            <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i> Advanced analytics</li>
                            <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i> Priority support</li>
                            <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i> Custom branding</li>
                            <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i> Early access to new features</li>
                        </ul>
                        
                        <form id="paymentForm">
                            <div class="mb-3">
                                <label for="cardNumber" class="form-label">Card Number</label>
                                <input type="text" class="form-control" id="cardNumber" placeholder="1234 5678 9012 3456">
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="expiryDate" class="form-label">Expiry Date</label>
                                    <input type="text" class="form-control" id="expiryDate" placeholder="MM/YY">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="cvv" class="form-label">CVV</label>
                                    <input type="password" class="form-control" id="cvv" placeholder="123">
                                </div>
                            </div>
                            <div class="mb-3">
                                <label for="cardName" class="form-label">Name on Card</label>
                                <input type="text" class="form-control" id="cardName">
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="confirmUpgrade">Upgrade Now - ₹499/month</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Load organiser profile data
        loadOrganiserProfile();
        
        // Handle social links form submission
        document.getElementById('saveSocialLinks').addEventListener('click', function() {
            // In a real implementation, this would save the social links to the database
            alert('Social links updated successfully!');
            // Close the modal
            bootstrap.Modal.getInstance(document.getElementById('socialLinksModal')).hide();
        });
        
        // Handle profile form submission
        document.getElementById('profileForm').addEventListener('submit', function(e) {
            e.preventDefault();
            saveProfile();
        });
        
        // Handle payment method toggle
        document.querySelectorAll('input[name="paymentMethod"]').forEach(radio => {
            radio.addEventListener('change', function() {
                if (this.value === 'bank_transfer') {
                    document.getElementById('bankTransferDetails').style.display = 'block';
                    document.getElementById('upiDetails').style.display = 'none';
                } else {
                    document.getElementById('bankTransferDetails').style.display = 'none';
                    document.getElementById('upiDetails').style.display = 'block';
                }
            });
        });
        
        // Handle payment info form submission
        document.getElementById('paymentInfoForm').addEventListener('submit', function(e) {
            e.preventDefault();
            savePaymentInfo();
        });
        
        // Handle verification submission
        document.getElementById('submitVerificationBtn').addEventListener('click', function() {
            submitVerification();
        });
        
        // Handle password change form
        document.getElementById('saveNewPassword').addEventListener('click', function() {
            changePassword();
        });
        
        // Password confirmation validation
        document.getElementById('confirmPassword').addEventListener('input', function() {
            validatePasswordMatch();
        });
        
        document.getElementById('newPassword').addEventListener('input', function() {
            validatePasswordMatch();
        });
        
        // Handle upgrade plan
        document.getElementById('confirmUpgrade').addEventListener('click', function() {
            upgradeToPremium();
        });
        
        // Handle notification settings changes
        const notificationSwitches = [
            'eventUpdates', 'newRegistrations', 'paymentAlerts', 'marketingEmails'
        ];
        
        notificationSwitches.forEach(id => {
            document.getElementById(id).addEventListener('change', function() {
                saveNotificationPreferences();
            });
        });
    });
    
    function validatePasswordMatch() {
        const newPassword = document.getElementById('newPassword').value;
        const confirmPassword = document.getElementById('confirmPassword').value;
        const errorDisplay = document.getElementById('passwordMatchError');
        const confirmInput = document.getElementById('confirmPassword');
        
        if (newPassword && confirmPassword) {
            if (newPassword !== confirmPassword) {
                confirmInput.classList.add('is-invalid');
                errorDisplay.style.display = 'block';
            } else {
                confirmInput.classList.remove('is-invalid');
                errorDisplay.style.display = 'none';
            }
        }
    }
    
    async function loadOrganiserProfile() {
        try {
            // In a real implementation, this would be an API call to load the organiser's profile
            // For now, we'll simulate the data
            
            // Simulate API call delay
            await new Promise(resolve => setTimeout(resolve, 800));
            
            const profileData = {
                id: 123,
                name: "John Doe",
                organizationName: "Tech Events India",
                email: "john.doe@example.com",
                phone: "+91 9876543210",
                profilePictureUrl: null, // Simulating no profile picture
                biography: "Passionate event organiser with over 5 years of experience in hosting technical workshops and conferences.",
                address: "123 Main Street, Tech Park",
                city: "Chennai",
                state: "Tamil Nadu",
                verificationStatus: "pending", // Options: pending, verified, rejected
                stats: {
                    eventsCreated: 12,
                    totalParticipants: 350,
                    averageRating: 4.7,
                    totalRevenue: 125000
                },
                socialLinks: {
                    facebook: "https://facebook.com/techeventsindia",
                    instagram: "https://instagram.com/techeventsindia",
                    twitter: "https://twitter.com/techeventsindia",
                    linkedin: "https://linkedin.com/company/techeventsindia"
                },
                documents: {
                    idProof: true,
                    addressProof: true,
                    organizationProof: false,
                    otherDocument: false
                },
                paymentInfo: {
                    method: "bank_transfer",
                    bankDetails: {
                        accountHolder: "John Doe",
                        accountNumber: "1234567890",
                        ifscCode: "ABCD0001234",
                        bankName: "State Bank of India",
                        branchName: "Chennai Main",
                        accountType: "savings"
                    },
                    upiDetails: {
                        upiId: "johndoe@okbank",
                        name: "John Doe"
                    },
                    panNumber: "ABCDE1234F"
                }
            };
            
            // Update UI with profile data
            updateProfileUI(profileData);
            
        } catch (error) {
            console.error('Error loading profile:', error);
            alert('Failed to load profile data. Please refresh the page and try again.');
        }
    }
    
    function updateProfileUI(data) {
        // Update profile header
        const avatarContainer = document.getElementById('avatarContainer');
        if (data.profilePictureUrl) {
            avatarContainer.innerHTML = `<img src="${data.profilePictureUrl}" alt="Profile Picture" class="profile-avatar">`;
        } else {
            avatarContainer.innerHTML = `<div class="avatar-placeholder">${data.name.charAt(0)}</div>`;
        }
        
        document.getElementById('organiserName').textContent = data.organizationName || data.name;
        
        // Update verification badge
        const verificationStatus = document.getElementById('verificationStatus');
        if (data.verificationStatus === 'verified') {
            verificationStatus.innerHTML = `<span class="verification-badge"><i class="fas fa-check-circle"></i> Verified Organiser</span>`;
        } else if (data.verificationStatus === 'pending') {
            verificationStatus.innerHTML = `<span class="verification-badge verification-pending"><i class="fas fa-clock"></i> Verification Pending</span>`;
        } else {
            verificationStatus.innerHTML = `<span class="verification-badge verification-rejected"><i class="fas fa-times-circle"></i> Verification Rejected</span>`;
        }
        
        // Update stats
        document.getElementById('eventsCreated').textContent = data.stats.eventsCreated;
        document.getElementById('totalParticipants').textContent = data.stats.totalParticipants;
        document.getElementById('averageRating').textContent = data.stats.averageRating;
        document.getElementById('totalRevenue').textContent = '₹' + data.stats.totalRevenue.toLocaleString();
        
        // Update basic info form
        document.getElementById('fullName').value = data.name;
        document.getElementById('displayName').value = data.organizationName || '';
        document.getElementById('email').value = data.email;
        document.getElementById('phone').value = data.phone || '';
        document.getElementById('biography').value = data.biography || '';
        document.getElementById('address').value = data.address || '';
        document.getElementById('city').value = data.city || '';
        document.getElementById('state').value = data.state || '';
        
        // Update verification status details
        const verificationStatusDetails = document.getElementById('verificationStatusDetails');
        if (data.verificationStatus === 'verified') {
            verificationStatusDetails.innerHTML = `
                <div class="alert alert-success">
                    <i class="fas fa-check-circle me-2"></i>
                    Your account is verified. You can create and publish events without restrictions.
                </div>
            `;
        } else if (data.verificationStatus === 'pending') {
            verificationStatusDetails.innerHTML = `
                <div class="alert alert-warning">
                    <i class="fas fa-clock me-2"></i>
                    Your verification is pending. Our team will review your documents and update you soon.
                </div>
            `;
        } else {
            verificationStatusDetails.innerHTML = `
                <div class="alert alert-danger">
                    <i class="fas fa-times-circle me-2"></i>
                    Your verification was rejected. Please update your documents and submit again.
                    <div class="mt-2">
                        <strong>Reason:</strong> The provided documents were unclear or invalid. Please ensure all documents are clear and valid.
                    </div>
                </div>
            `;
        }
        
        // Update document statuses
        updateDocumentStatus('idProof', data.documents.idProof);
        updateDocumentStatus('addressProof', data.documents.addressProof);
        updateDocumentStatus('organizationProof', data.documents.organizationProof);
        updateDocumentStatus('otherDocument', data.documents.otherDocument);
        
        // Update payment info
        if (data.paymentInfo) {
            if (data.paymentInfo.method === 'bank_transfer') {
                document.getElementById('bankTransfer').checked = true;
            } else {
                document.getElementById('upi').checked = true;
                document.getElementById('bankTransferDetails').style.display = 'none';
                document.getElementById('upiDetails').style.display = 'block';
            }
            
            if (data.paymentInfo.bankDetails) {
                document.getElementById('accountHolder').value = data.paymentInfo.bankDetails.accountHolder || '';
                document.getElementById('accountNumber').value = data.paymentInfo.bankDetails.accountNumber || '';
                document.getElementById('ifscCode').value = data.paymentInfo.bankDetails.ifscCode || '';
                document.getElementById('bankName').value = data.paymentInfo.bankDetails.bankName || '';
                document.getElementById('branchName').value = data.paymentInfo.bankDetails.branchName || '';
                document.getElementById('accountType').value = data.paymentInfo.bankDetails.accountType || 'savings';
            }
            
            if (data.paymentInfo.upiDetails) {
                document.getElementById('upiId').value = data.paymentInfo.upiDetails.upiId || '';
                document.getElementById('upiName').value = data.paymentInfo.upiDetails.name || '';
            }
            
            document.getElementById('panNumber').value = data.paymentInfo.panNumber || '';
        }
        
        // Update social links
        document.getElementById('facebookLink').value = data.socialLinks?.facebook || '';
        document.getElementById('instagramLink').value = data.socialLinks?.instagram || '';
        document.getElementById('twitterLink').value = data.socialLinks?.twitter || '';
        document.getElementById('linkedinLink').value = data.socialLinks?.linkedin || '';
    }
    
    function updateDocumentStatus(documentId, isUploaded) {
        const documentElement = document.getElementById(documentId);
        const statusElement = document.getElementById(`${documentId}Status`);
        
        if (isUploaded) {
            documentElement.classList.add('uploaded');
            statusElement.innerHTML = `<span class="text-success"><i class="fas fa-check-circle me-1"></i> Document uploaded</span>`;
        } else {
            statusElement.innerHTML = `<span class="text-muted">No document uploaded</span>`;
        }
    }
    
    function saveProfile() {
        // In a real implementation, this would save the profile data to the database
        alert('Profile updated successfully!');
        
        // Add to activity log
        const nowText = "Just now";
        const activityHtml = `
            <li class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                    <div><strong>Profile updated</strong></div>
                    <small class="text-muted">You updated your profile information</small>
                </div>
                <small class="text-muted">${nowText}</small>
            </li>
        `;
        
        const activityLog = document.getElementById('activityLog');
        activityLog.insertAdjacentHTML('afterbegin', activityHtml);
    }
    
    function savePaymentInfo() {
        // In a real implementation, this would save the payment info to the database
        alert('Payment information updated successfully!');
    }
    
    function submitVerification() {
        // In a real implementation, this would submit the verification documents to the database
        alert('Verification documents submitted successfully! Our team will review your documents and update you soon.');
        
        // Update verification status
        const verificationStatusDetails = document.getElementById('verificationStatusDetails');
        verificationStatusDetails.innerHTML = `
            <div class="alert alert-warning">
                <i class="fas fa-clock me-2"></i>
                Your verification is pending. Our team will review your documents and update you soon.
            </div>
        `;
        
        // Add to activity log
        const nowText = "Just now";
        const activityHtml = `
            <li class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                    <div><strong>Verification submitted</strong></div>
                    <small class="text-muted">You submitted verification documents</small>
                </div>
                <small class="text-muted">${nowText}</small>
            </li>
        `;
        
        const activityLog = document.getElementById('activityLog');
        activityLog.insertAdjacentHTML('afterbegin', activityHtml);
    }
    
    function changePassword() {
        const currentPassword = document.getElementById('currentPassword').value;
        const newPassword = document.getElementById('newPassword').value;
        const confirmPassword = document.getElementById('confirmPassword').value;
        
        if (!currentPassword || !newPassword || !confirmPassword) {
            alert('Please fill all password fields');
            return;
        }
        
        if (newPassword !== confirmPassword) {
            alert('New passwords do not match');
            return;
        }
        
        // In a real implementation, this would change the password in the database
        alert('Password changed successfully!');
        
        // Close the modal
        bootstrap.Modal.getInstance(document.getElementById('changePasswordModal')).hide();
        
        // Reset form
        document.getElementById('changePasswordForm').reset();
        
        // Add to activity log
        const nowText = "Just now";
        const activityHtml = `
            <li class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                    <div><strong>Password changed</strong></div>
                    <small class="text-muted">You changed your account password</small>
                </div>
                <small class="text-muted">${nowText}</small>
            </li>
        `;
        
        const activityLog = document.getElementById('activityLog');
        activityLog.insertAdjacentHTML('afterbegin', activityHtml);
    }
    
    function saveNotificationPreferences() {
        // In a real implementation, this would save the notification preferences to the database
        console.log('Notification preferences updated');
    }
    
    function upgradeToPremium() {
        const cardNumber = document.getElementById('cardNumber').value;
        const expiryDate = document.getElementById('expiryDate').value;
        const cvv = document.getElementById('cvv').value;
        const cardName = document.getElementById('cardName').value;
        
        if (!cardNumber || !expiryDate || !cvv || !cardName) {
            alert('Please fill all payment fields');
            return;
        }
        
        // In a real implementation, this would process the payment and upgrade the subscription
        alert('Congratulations! Your account has been upgraded to Premium.');
        
        // Close the modal
        bootstrap.Modal.getInstance(document.getElementById('upgradePlanModal')).hide();
        
        // Update subscription display
        const subscriptionTab = document.getElementById('subscription');
        subscriptionTab.querySelector('.subscription-card').className = 'subscription-card subscription-premium';
        subscriptionTab.querySelector('.subscription-header h5').textContent = 'Premium Plan';
        subscriptionTab.querySelector('.subscription-body ul').innerHTML = `
            <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i> Unlimited events</li>
            <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i> Advanced analytics</li>
            <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i> Priority support</li>
            <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i> Custom branding</li>
            <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i> Early access to new features</li>
        `;
        
        // Hide upsell card
        subscriptionTab.querySelector('.upsell-card').style.display = 'none';
        
        // Add to activity log
        const nowText = "Just now";
        const activityHtml = `
            <li class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                    <div><strong>Subscription upgraded</strong></div>
                    <small class="text-muted">You upgraded to Premium plan</small>
                </div>
                <small class="text-muted">${nowText}</small>
            </li>
        `;
        
        const activityLog = document.getElementById('activityLog');
        activityLog.insertAdjacentHTML('afterbegin', activityHtml);
    }
</script>
{% endblock %}