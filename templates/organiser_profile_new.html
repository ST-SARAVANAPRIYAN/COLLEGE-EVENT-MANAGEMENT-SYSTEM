{% extends 'organiser_base.html' %}

{% block title %}CEMS - Organiser Profile{% endblock %}

{% block page_title %}Organiser Profile{% endblock %}

{% block extra_styles %}
.profile-section {
    background-color: white;
    border-radius: 10px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
    padding: 20px;
    margin-bottom: 20px;
}

.profile-header {
    display: flex;
    align-items: center;
    margin-bottom: 20px;
}

.profile-avatar {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    object-fit: cover;
    margin-right: 20px;
    border: 3px solid var(--primary-color);
}

.avatar-placeholder {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    background-color: #e9ecef;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 20px;
    font-size: 2.5rem;
    color: #adb5bd;
}

.profile-stats {
    display: flex;
    flex-wrap: wrap;
    margin-bottom: 20px;
}

.stat-item {
    padding: 15px;
    background-color: #f8f9fa;
    border-radius: 10px;
    margin-right: 15px;
    margin-bottom: 15px;
    min-width: 120px;
    text-align: center;
    transition: transform 0.2s;
}

.stat-item:hover {
    transform: translateY(-5px);
    box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
}

.stat-value {
    font-size: 1.5rem;
    font-weight: bold;
    display: block;
}

.stat-label {
    font-size: 0.8rem;
    color: #6c757d;
}

.nav-pills .nav-link.active {
    background-color: var(--primary-color);
}

.tab-content {
    padding: 20px;
    background-color: white;
    border-radius: 0 0 10px 10px;
}

.verification-badge {
    background-color: #e3fcef;
    color: #00a854;
    border-radius: 50px;
    padding: 5px 10px;
    font-size: 12px;
    font-weight: bold;
    display: inline-flex;
    align-items: center;
}

.verification-badge i {
    margin-right: 5px;
}

.verification-pending {
    background-color: #fff7e6;
    color: #fa8c16;
}

.verification-rejected {
    background-color: #fff1f0;
    color: #f5222d;
}

.document-card {
    border: 1px dashed #dee2e6;
    border-radius: 8px;
    padding: 15px;
    margin-bottom: 15px;
    background-color: #f8f9fa;
    transition: all 0.2s;
}

.document-card:hover {
    border-color: var(--primary-color);
}

.document-card.uploaded {
    border-style: solid;
    border-color: #28a745;
    background-color: #f0fff4;
}

.social-links {
    display: flex;
    gap: 10px;
    margin-top: 10px;
}

.social-icon {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: #f8f9fa;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #6c757d;
    transition: all 0.2s;
}

.social-icon:hover {
    transform: translateY(-3px);
}

.facebook:hover {
    background-color: #3b5998;
    color: white;
}

.instagram:hover {
    background-color: #e1306c;
    color: white;
}

.twitter:hover {
    background-color: #1da1f2;
    color: white;
}

.linkedin:hover {
    background-color: #0077b5;
    color: white;
}

.subscription-card {
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
    margin-bottom: 20px;
}

.subscription-header {
    padding: 15px;
    background-color: #e9ecef;
    font-weight: bold;
    text-align: center;
}

.subscription-free .subscription-header {
    background-color: #e3fcef;
    color: #00a854;
}

.subscription-premium .subscription-header {
    background-color: #fff1f0;
    color: #f5222d;
}

.subscription-body {
    padding: 15px;
    background-color: white;
}

.upsell-card {
    background: linear-gradient(45deg, #3e64ff, #5edfff);
    color: white;
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 20px;
}
{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <!-- Profile Information -->
        <div class="col-lg-8">
            <div class="profile-section">
                <div class="profile-header">
                    <div id="avatarContainer">
                        <!-- Will be populated with image or placeholder -->
                    </div>
                    <div>
                        <h3 id="organiserName">Loading...</h3>
                        <div id="verificationStatus"></div>
                        <div class="social-links">
                            <a href="#" class="social-icon facebook" title="Facebook">
                                <i class="fab fa-facebook-f"></i>
                            </a>
                            <a href="#" class="social-icon instagram" title="Instagram">
                                <i class="fab fa-instagram"></i>
                            </a>
                            <a href="#" class="social-icon twitter" title="Twitter">
                                <i class="fab fa-twitter"></i>
                            </a>
                            <a href="#" class="social-icon linkedin" title="LinkedIn">
                                <i class="fab fa-linkedin-in"></i>
                            </a>
                            <button class="btn btn-sm btn-outline-secondary ms-2" data-bs-toggle="modal" data-bs-target="#socialLinksModal">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="profile-stats">
                    <div class="stat-item">
                        <span class="stat-value" id="eventsCreated">-</span>
                        <span class="stat-label">Events Created</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="totalParticipants">-</span>
                        <span class="stat-label">Participants</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="averageRating">-</span>
                        <span class="stat-label">Avg. Rating</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="totalRevenue">-</span>
                        <span class="stat-label">Total Revenue</span>
                    </div>
                </div>
                
                <ul class="nav nav-pills mb-3" id="profileTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="info-tab" data-bs-toggle="pill" data-bs-target="#info" type="button" role="tab" aria-controls="info" aria-selected="true">Basic Info</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="payment-tab" data-bs-toggle="pill" data-bs-target="#payment" type="button" role="tab" aria-controls="payment" aria-selected="false">Payment Info</button>
                    </li>
                </ul>
                
                <div class="tab-content" id="profileTabsContent">
                    <!-- Basic Info Tab -->
                    <div class="tab-pane fade show active" id="info" role="tabpanel" aria-labelledby="info-tab">
                        <form id="profileForm">
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="fullName" class="form-label">Full Name</label>
                                    <input type="text" class="form-control" id="fullName">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="displayName" class="form-label">Display Name / Organization Name</label>
                                    <input type="text" class="form-control" id="displayName">
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="email" class="form-label">Email</label>
                                    <input type="email" class="form-control" id="email" readonly>
                                    <div class="form-text">Email cannot be changed. Contact support for assistance.</div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="phone" class="form-label">Phone</label>
                                    <input type="text" class="form-control" id="phone">
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="biography" class="form-label">Biography/About</label>
                                <textarea class="form-control" id="biography" rows="3"></textarea>
                            </div>
                            
                            <div class="mb-3">
                                <label for="address" class="form-label">Address</label>
                                <textarea class="form-control" id="address" rows="2"></textarea>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="city" class="form-label">City</label>
                                    <input type="text" class="form-control" id="city">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="state" class="form-label">State</label>
                                    <input type="text" class="form-control" id="state">
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="profilePic" class="form-label">Profile Picture</label>
                                <input class="form-control" type="file" id="profilePic" accept="image/*">
                            </div>
                            
                            <button type="submit" class="btn btn-primary">Save Changes</button>
                        </form>
                    </div>
                    
                    <!-- Payment Info Tab -->
                    <div class="tab-pane fade" id="payment" role="tabpanel" aria-labelledby="payment-tab">
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle me-2"></i>
                            Your UPI ID is used to receive payments from ticket sales and other event revenue.
                        </div>
                        <form id="paymentInfoForm">
                            <!-- UPI Details Only -->
                            <div class="mb-3">
                                <label for="upiId" class="form-label">UPI ID</label>
                                <input type="text" class="form-control" id="upiId" placeholder="username@bankname">
                                <div class="form-text">Enter your UPI ID in the format username@bankname</div>
                            </div>
                            <button type="submit" class="btn btn-primary">Save Payment Information</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Account Settings & Security -->
        <div class="col-lg-4">
            <div class="profile-section">
                <h5 class="mb-3">Account Settings</h5>
                
                <div class="mb-3">
                    <label class="form-label">Email Notifications</label>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="eventUpdates" checked>
                        <label class="form-check-label" for="eventUpdates">Event updates</label>
                    </div>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="newRegistrations" checked>
                        <label class="form-check-label" for="newRegistrations">New registrations</label>
                    </div>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="paymentAlerts" checked>
                        <label class="form-check-label" for="paymentAlerts">Payment alerts</label>
                    </div>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="marketingEmails">
                        <label class="form-check-label" for="marketingEmails">Marketing emails</label>
                    </div>
                </div>
                
                <hr>
                
                <h5 class="mb-3">Security</h5>
                
                <div class="d-grid gap-2">
                    <button type="button" class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#changePasswordModal">
                        <i class="fas fa-lock me-2"></i> Change Password
                    </button>
                    <button type="button" class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#enable2FAModal">
                        <i class="fas fa-shield-alt me-2"></i> Enable Two-Factor Authentication
                    </button>
                </div>
                
                <hr>
                
                <h5 class="mb-3">Account Actions</h5>
                
                <div class="d-grid gap-2">
                    <button type="button" class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#deactivateAccountModal">
                        <i class="fas fa-pause-circle me-2"></i> Deactivate Account
                    </button>
                    <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#deleteAccountModal">
                        <i class="fas fa-trash-alt me-2"></i> Delete Account
                    </button>
                </div>
            </div>
            
            <!-- Activity Log -->
            <div class="profile-section">
                <h5 class="mb-3">Recent Activity</h5>
                <ul class="list-group list-group-flush" id="activityLog">
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <div>
                            <div><strong>Profile updated</strong></div>
                            <small class="text-muted">You updated your profile information</small>
                        </div>
                        <small class="text-muted">2 days ago</small>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <div>
                            <div><strong>New event created</strong></div>
                            <small class="text-muted">You created event "Technical Workshop"</small>
                        </div>
                        <small class="text-muted">5 days ago</small>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <div>
                            <div><strong>Password changed</strong></div>
                            <small class="text-muted">You changed your account password</small>
                        </div>
                        <small class="text-muted">1 week ago</small>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>

<!-- Social Links Modal -->
<div class="modal fade" id="socialLinksModal" tabindex="-1" aria-labelledby="socialLinksModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="socialLinksModalLabel">Edit Social Links</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="socialLinksForm">
                    <div class="mb-3">
                        <label for="facebookLink" class="form-label">Facebook Profile URL</label>
                        <input type="text" class="form-control" id="facebookLink">
                    </div>
                    <div class="mb-3">
                        <label for="instagramLink" class="form-label">Instagram Profile URL</label>
                        <input type="text" class="form-control" id="instagramLink">
                    </div>
                    <div class="mb-3">
                        <label for="twitterLink" class="form-label">Twitter Profile URL</label>
                        <input type="text" class="form-control" id="twitterLink">
                    </div>
                    <div class="mb-3">
                        <label for="linkedinLink" class="form-label">LinkedIn Profile URL</label>
                        <input type="text" class="form-control" id="linkedinLink">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="saveSocialLinks">Save changes</button>
            </div>
        </div>
    </div>
</div>

<!-- Change Password Modal -->
<div class="modal fade" id="changePasswordModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Change Password</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="changePasswordForm">
                    <div class="mb-3">
                        <label for="currentPassword" class="form-label">Current Password</label>
                        <input type="password" class="form-control" id="currentPassword" required>
                    </div>
                    <div class="mb-3">
                        <label for="newPassword" class="form-label">New Password</label>
                        <input type="password" class="form-control" id="newPassword" required>
                    </div>
                    <div class="mb-3">
                        <label for="confirmPassword" class="form-label">Confirm New Password</label>
                        <input type="password" class="form-control" id="confirmPassword" required>
                        <div id="passwordMatchError" class="invalid-feedback">
                            Passwords do not match.
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="saveNewPassword">Change Password</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Helper function to get CSRF token
    function getCsrfToken() {
        const metaTag = document.querySelector('meta[name="csrf-token"]');
        return metaTag ? metaTag.getAttribute('content') : '';
    }

    document.addEventListener('DOMContentLoaded', function() {
        // Load organiser profile data
        loadOrganiserProfile();
        
        // Handle social links form submission
        document.getElementById('saveSocialLinks').addEventListener('click', function() {
            // In a real implementation, this would save the social links to the database
            alert('Social links updated successfully!');
            // Close the modal
            bootstrap.Modal.getInstance(document.getElementById('socialLinksModal')).hide();
        });
        
        // Handle profile form submission
        document.getElementById('profileForm').addEventListener('submit', function(e) {
            e.preventDefault();
            saveProfile();
        });
        
        // Handle payment info form submission
        document.getElementById('paymentInfoForm').addEventListener('submit', function(e) {
            e.preventDefault();
            savePaymentInfo();
        });
        
        // Handle password change form
        document.getElementById('saveNewPassword').addEventListener('click', function() {
            changePassword();
        });
        
        // Password confirmation validation
        document.getElementById('confirmPassword').addEventListener('input', function() {
            validatePasswordMatch();
        });
        
        document.getElementById('newPassword').addEventListener('input', function() {
            validatePasswordMatch();
        });
        
        // Handle notification settings changes
        const notificationSwitches = [
            'eventUpdates', 'newRegistrations', 'paymentAlerts', 'marketingEmails'
        ];
        
        notificationSwitches.forEach(id => {
            document.getElementById(id).addEventListener('change', function() {
                saveNotificationPreferences();
            });
        });
    });
    
    function validatePasswordMatch() {
        const newPassword = document.getElementById('newPassword').value;
        const confirmPassword = document.getElementById('confirmPassword').value;
        const errorDisplay = document.getElementById('passwordMatchError');
        const confirmInput = document.getElementById('confirmPassword');
        
        if (newPassword && confirmPassword) {
            if (newPassword !== confirmPassword) {
                confirmInput.classList.add('is-invalid');
                errorDisplay.style.display = 'block';
            } else {
                confirmInput.classList.remove('is-invalid');
                errorDisplay.style.display = 'none';
            }
        }
    }
    
    async function loadOrganiserProfile() {
        try {
            // Show loading state
            document.getElementById('organiserName').textContent = 'Loading...';
            
            // Fetch the organiser profile data from the API
            const response = await fetch('/api/profile');
            const data = await response.json();
            
            if (!data.success) {
                throw new Error(data.error || 'Failed to load profile data');
            }
            
            // Update UI with profile data
            updateProfileUI(data.profile);
            
        } catch (error) {
            console.error('Error loading profile:', error);
            alert('Failed to load profile data. Please refresh the page and try again.');
        }
    }
    
    function updateProfileUI(data) {
        // Update profile header
        const avatarContainer = document.getElementById('avatarContainer');
        if (data.profilePictureUrl) {
            avatarContainer.innerHTML = `<img src="${data.profilePictureUrl}" alt="Profile Picture" class="profile-avatar">`;
        } else {
            avatarContainer.innerHTML = `<div class="avatar-placeholder">${data.name.charAt(0)}</div>`;
        }
        
        document.getElementById('organiserName').textContent = data.organizationName || data.name;
        
        // Update verification badge
        const verificationStatus = document.getElementById('verificationStatus');
        if (data.verificationStatus === 'verified') {
            verificationStatus.innerHTML = `<span class="verification-badge"><i class="fas fa-check-circle"></i> Verified Organiser</span>`;
        } else if (data.verificationStatus === 'pending') {
            verificationStatus.innerHTML = `<span class="verification-badge verification-pending"><i class="fas fa-clock"></i> Verification Pending</span>`;
        } else {
            verificationStatus.innerHTML = `<span class="verification-badge verification-rejected"><i class="fas fa-times-circle"></i> Verification Rejected</span>`;
        }
        
        // Update stats
        document.getElementById('eventsCreated').textContent = data.stats.eventsCreated;
        document.getElementById('totalParticipants').textContent = data.stats.totalParticipants;
        document.getElementById('averageRating').textContent = data.stats.averageRating;
        document.getElementById('totalRevenue').textContent = 'â‚¹' + data.stats.totalRevenue.toLocaleString();
        
        // Update basic info form
        document.getElementById('fullName').value = data.name;
        document.getElementById('displayName').value = data.organizationName || '';
        document.getElementById('email').value = data.email;
        document.getElementById('phone').value = data.phone || '';
        document.getElementById('biography').value = data.biography || '';
        document.getElementById('address').value = data.address || '';
        document.getElementById('city').value = data.city || '';
        document.getElementById('state').value = data.state || '';
        
        // Update payment info
        if (data.paymentInfo) {
            if (data.paymentInfo.upiDetails) {
                document.getElementById('upiId').value = data.paymentInfo.upiDetails.upiId || '';
            }
        }
        
        // Update social links
        document.getElementById('facebookLink').value = data.socialLinks?.facebook || '';
        document.getElementById('instagramLink').value = data.socialLinks?.instagram || '';
        document.getElementById('twitterLink').value = data.socialLinks?.twitter || '';
        document.getElementById('linkedinLink').value = data.socialLinks?.linkedin || '';
    }
    
    async function saveProfile() {
        try {
            // Get form data
            const profileData = {
                name: document.getElementById('fullName').value,
                organizationName: document.getElementById('displayName').value,
                phone: document.getElementById('phone').value,
                biography: document.getElementById('biography').value,
                address: document.getElementById('address').value,
                city: document.getElementById('city').value,
                state: document.getElementById('state').value
            };
            
            // Send data to server
            const response = await fetch('/api/profile', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': getCsrfToken()
                },
                body: JSON.stringify(profileData)
            });
            
            const data = await response.json();
            
            if (!data.success) {
                throw new Error(data.error || 'Failed to update profile');
            }
            
            alert('Profile updated successfully!');
            
            // Reload profile data to reflect updates
            await loadOrganiserProfile();
            
            // Add to activity log
            const nowText = "Just now";
            const activityHtml = `
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    <div>
                        <div><strong>Profile updated</strong></div>
                        <small class="text-muted">You updated your profile information</small>
                    </div>
                    <small class="text-muted">${nowText}</small>
                </li>
            `;
            
            const activityLog = document.getElementById('activityLog');
            activityLog.insertAdjacentHTML('afterbegin', activityHtml);
        } catch (error) {
            console.error('Error saving profile:', error);
            alert('Failed to update profile. Please try again.');
        }
    }    // UPI ID validation
    function validateUpiId(upiId) {
        // UPI ID format typically: username@bankname
        const upiRegex = /^[a-zA-Z0-9_.-]+@[a-zA-Z0-9]+$/;
        return upiRegex.test(upiId);
    }
    
    async function savePaymentInfo() {
        try {
            // Only UPI method is supported, only upiId field is present
            const upiIdInput = document.getElementById('upiId');
            if (!upiIdInput) {
                alert('UPI ID field not found.');
                return;
            }
            const upiId = upiIdInput.value;
            // Validate UPI ID
            if (upiId.trim() !== '' && !validateUpiId(upiId)) {
                alert('Please enter a valid UPI ID in the format username@bankname');
                return;
            }
            let paymentData = {
                method: 'upi',
                upiDetails: {
                    upiId: upiId
                }
            };
            // Send payment info to server
            const response = await fetch('/api/profile/payment', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': getCsrfToken()
                },
                body: JSON.stringify(paymentData)
            });
            const result = await response.json();
            if (!result.success) {
                throw new Error(result.error || 'Failed to update payment information');
            }
            alert('Payment information updated successfully!');
            // Add to activity log
            const nowText = "Just now";
            const activityHtml = `
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    <div>
                        <div><strong>Payment info updated</strong></div>
                        <small class="text-muted">You updated your payment information</small>
                    </div>
                    <small class="text-muted">${nowText}</small>
                </li>
            `;
            const activityLog = document.getElementById('activityLog');
            activityLog.insertAdjacentHTML('afterbegin', activityHtml);
        } catch (error) {
            console.error('Error saving payment info:', error);
            alert('Failed to update payment information. Please try again.');
        }
    }
    
    function changePassword() {
        const currentPassword = document.getElementById('currentPassword').value;
        const newPassword = document.getElementById('newPassword').value;
        const confirmPassword = document.getElementById('confirmPassword').value;
        
        if (!currentPassword || !newPassword || !confirmPassword) {
            alert('Please fill all password fields');
            return;
        }
        
        if (newPassword !== confirmPassword) {
            alert('New passwords do not match');
            return;
        }
        
        // In a real implementation, this would change the password in the database
        alert('Password changed successfully!');
        
        // Close the modal
        bootstrap.Modal.getInstance(document.getElementById('changePasswordModal')).hide();
        
        // Reset form
        document.getElementById('changePasswordForm').reset();
        
        // Add to activity log
        const nowText = "Just now";
        const activityHtml = `
            <li class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                    <div><strong>Password changed</strong></div>
                    <small class="text-muted">You changed your account password</small>
                </div>
                <small class="text-muted">${nowText}</small>
            </li>
        `;
        
        const activityLog = document.getElementById('activityLog');
        activityLog.insertAdjacentHTML('afterbegin', activityHtml);
    }
    
    function saveNotificationPreferences() {
        // In a real implementation, this would save the notification preferences to the database
        console.log('Notification preferences updated');
    }
</script>
{% endblock %}
